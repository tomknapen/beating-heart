version: '2'

volumes:
  node-red-data:
  pihole_config:
  dnsmasq_config:
  dnscrypt_config:

services:
  mqtt:
    image: panuwitp/mosquitto-arm
    ports:
      - '1883:1883'

  node-red:
    build: node-red
    volumes:
      - 'node-red-data:/data'
    ports:
      - '1880:1880'
    depends_on:
      - mqtt
    restart: always
  # https://github.com/klutchell/balena-pihole/blob/master/docker-compose.yml
  # pihole:
  #   build: ./pihole
  #   privileged: true
  #   volumes:
  #     - 'pihole_config:/etc/pihole'
  #     - 'dnsmasq_config:/etc/dnsmasq.d'
  #   cap_add:
  #     - 'NET_ADMIN'
  #   dns:
  #     - '127.0.0.1'
  #     - '1.1.1.1'
  #   network_mode: host
  # # set pihole DNS1 and DNS2 service variables to 127.0.0.1#5053 to use dnscrypt-proxy for upstream DNS
  # # dnscrypt-proxy:
  # #   build: ./dnscrypt-proxy
  # #   volumes:
  # #     - 'dnscrypt_config:/config'
  # #   ports:
  # #     - '5053:5053/udp'
